<div id="studentResult"></div>

<script>
const urlParams = new URLSearchParams(window.location.search);
const studentName = urlParams.get("name");
const studentClass = urlParams.get("class");

async function loadData() {
  const response = await fetch("students_results.csv");
  const text = await response.text();
  const rows = text.split("\n").slice(1); // ØªØ¬Ø§Ù‡Ù„ Ø§Ù„Ø¹Ù†Ø§ÙˆÙŠÙ†

  let found = false;
  rows.forEach(row => {
    const cols = row.split(",");
    const name = cols[0]?.trim();
    const cls = cols[1]?.trim();

    if (name === studentName && cls === studentClass) {
      found = true;
      let total = 0, maxTotal = 0;
      let table = "<table><tr><th>Ø§Ù„Ø­ØµØ©</th><th>Ø§Ù„Ø¯Ø±Ø¬Ø©</th></tr>";

      cols.slice(2).forEach((grade, i) => {
        if (grade) {
          const [got, max] = grade.split("/").map(x => parseInt(x));
          total += got;
          maxTotal += max;
          table += `<tr><td>Ø§Ù„Ø­ØµØ© ${i+1}</td><td>${got} / ${max}</td></tr>`;
        }
      });

      const percent = (total / maxTotal) * 100;
      let status = "";
      if (percent >= 85) status = `<div class="grade excellent">ğŸŒŸ Ù…Ù…ØªØ§Ø²</div>`;
      else if (percent >= 70) status = `<div class="grade verygood">ğŸ‘ Ø¬ÙŠØ¯ Ø¬Ø¯Ù‹Ø§</div>`;
      else if (percent >= 50) status = `<div class="grade good">ğŸ™‚ Ø¬ÙŠØ¯</div>`;
      else status = `<div class="grade weak">âš ï¸ Ø¶Ø¹ÙŠÙ</div>`;

      table += `<tr><th>Ø§Ù„Ù…Ø¬Ù…ÙˆØ¹</th><td>${total} / ${maxTotal}</td></tr>`;
      table += `<tr><th>Ø§Ù„Ù†Ø³Ø¨Ø© Ø§Ù„Ù…Ø¦ÙˆÙŠØ©</th><td>${percent.toFixed(2)}%</td></tr>`;
      table += "</table>";

      document.getElementById("studentResult").innerHTML = `
        <h2>${name}</h2>
        <h3>${cls}</h3>
        ${table}
        ${status}
      `;
    }
  });

  if (!found) {
    document.getElementById("studentResult").innerHTML =
      `<p style="color:red; font-weight:bold;">âš ï¸ Ø§Ù„Ø·Ø§Ù„Ø¨ Ø£Ùˆ Ø§Ù„ØµÙ ØºÙŠØ± Ù…ÙˆØ¬ÙˆØ¯</p>`;
  }
}
loadData();
</script>
